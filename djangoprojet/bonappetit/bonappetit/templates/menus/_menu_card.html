{% if menu.disponible %}
<div class="menus d-flex align-items-center ftco-animate mb-4 p-2">
  {% if menu.image %}
  <div class="menu-img img flex-shrink-0 me-3" style="background-image: url('{{ menu.image.url }}'); width:110px; height:110px; background-size:cover; background-position:center; border-radius:14px; box-shadow:0 2px 8px rgba(0,0,0,0.10);"></div>
  {% endif %}
  <div class="text w-100">
    <div class="d-flex flex-column">
      <div class="d-flex justify-content-between align-items-center mb-1">
        <h5 class="mb-0 fw-bold text-truncate" style="font-size:1.25rem; max-width:70%;" title="{{ menu.nom }}">{{ menu.nom }}</h5>
      </div>
      <div class="d-flex justify-content-end">
        <span class="price" style="font-size:1.1rem; font-weight:600;">{{ menu.prix|floatformat:0 }} FCFA</span>
      </div>
    </div>
    <p class="mb-2 text-muted" style="font-size:1.05rem;">{{ menu.description|truncatewords:20 }}</p>
    <div class="d-flex gap-2 mt-1">
      <!-- Bouton voir détails (modal) -->
      <button type="button" class="btn btn-outline-primary btn-sm rounded-circle p-1" id="id_detailsbuton" style="width:32px;height:32px;" data-bs-toggle="modal" data-bs-target="#menuModal{{ menu.id }}" title="Voir détails">
        <i class="fa fa-eye text-primary"></i>
      </button>
      <!-- Bouton ajouter au panier (si connecté et client) -->
      {% if user.is_authenticated and user.is_client %}
      <form method="post" action="{% url 'ajouter_au_panier' menu.id %}" class="d-inline">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-success btn-sm rounded-circle p-1" id="id_ajoutpanier" style="width:32px;height:32px;" title="Ajouter au panier">
          <i class="fa fa-cart-plus text-success"></i>
        </button>
      </form>
      {% endif %}
    </div>
  </div>
</div>

<!-- Modal pour les détails du menu -->
<div class="modal fade" id="menuModal{{ menu.id }}" tabindex="-1" aria-labelledby="menuModalLabel{{ menu.id }}" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title fw-bold" id="menuModalLabel{{ menu.id }}" style="font-size:1.5rem;">{{ menu.nom }}</h4>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row">
          {% if menu.image %}
          <div class="col-md-6 d-flex align-items-center justify-content-center mb-3 mb-md-0">
            <img src="{{ menu.image.url }}" class="img-fluid rounded shadow" alt="{{ menu.nom }}" style="max-height:340px;object-fit:cover;">
          </div>
          {% endif %}
          <div class="col-md-{% if menu.image %}6{% else %}12{% endif %}">
            <h6 class="mb-2" style="font-size:1.1rem;">Description</h6>
            <p style="font-size:1.05rem;">{{ menu.description }}</p>
            <h6 class="mb-2" style="font-size:1.1rem;">Catégorie</h6>
            <p style="font-size:1.05rem;">{{ menu.get_categorie_display }}</p>
            <div class="d-flex justify-content-between align-items-center mt-4">
              <h5 class="mb-0" style="font-size:1.2rem;">Prix: {{ menu.prix|floatformat:0 }} FCFA</h5>
              {% if user.is_authenticated and user.is_client %}
              <form method="post" action="{% url 'ajouter_au_panier' menu.id %}" class="d-inline">
                {% csrf_token %}
                <button type="submit" class="btn btn-outline-success btn-sm rounded-circle p-1" style="width:36px;height:36px;" title="Ajouter au panier">
                  <i class="fa fa-cart-plus text-success"></i>
                </button>
              </form>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}