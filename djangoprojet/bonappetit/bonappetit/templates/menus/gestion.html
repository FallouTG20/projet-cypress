{% extends 'base.html' %}
{% load widget_tweaks %}

{% block title %}Gestion des menus{% endblock %}

{% block content %}
<!-- {% if messages %}
  <div class="mt-3">
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  </div>
{% endif %} -->
<div class="row">
  <!-- Colonne Formulaire -->
  <div class="col-md-4">
    <h3 class="mb-3">Ajouter un menu</h3>
    <div class="card p-3 shadow-sm">
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="mb-3">
          <label for="id_nom" class="form-label">Nom :</label>
          {{ form.nom|add_class:"form-control" }}
        </div>
        <div class="mb-3">
          <label for="id_description" class="form-label">Description :</label>
          {{ form.description|add_class:"form-control" }}
        </div>
        <div class="mb-3">
          <label for="id_prix" class="form-label">Prix :</label>
          {{ form.prix|add_class:"form-control" }}
        </div>
        <div class="mb-3">
          <label for="id_image" class="form-label">Image :</label>
          {{ form.image|add_class:"form-control" }}
        </div>
        <div class="mb-3">
          <label for="id_categorie" class="form-label">Catégorie :</label>
          {{ form.categorie|add_class:"form-select" }}
        </div>
        <div class="form-check mb-3">
          {{ form.disponible }}
          <label for="id_disponible" class="form-check-label">Disponible</label>
        </div>
        <button type="submit" class="btn btn-success w-100">Ajouter</button>
      </form>
    </div>
  </div>

  <!-- Colonne Liste des Menus -->
  <div class="col-md-8">
    <h3 class="mb-3">Menus existants</h3>
    <div class="row">
      {% for menu in menus %}
      <div class="col-md-6 mb-4 d-flex">
        <div class="card h-100 shadow-sm d-flex flex-column w-100">
          {% if menu.image %}
          <img src="{{ menu.image.url }}" class="card-img-top" alt="{{ menu.nom }}">
          {% endif %}
          <div class="card-body flex-grow-1 d-flex flex-column">
            <h5 class="card-title">{{ menu.nom }}</h5>
            <p class="card-text">{{ menu.description }}</p>
            <p><strong>{{ menu.prix }} FCFA</strong></p>
            <p class="badge bg-{{ menu.disponible|yesno:"success,danger" }}">
              {% if menu.disponible %}Disponible{% else %}Indisponible{% endif %}
            </p>
            <div class="mt-2 d-flex justify-content-between mt-auto">
              <a href="{% url 'modifier_menu' menu.id %}" class="btn btn-warning btn-sm">Modifier</a>
              <a href="{% url 'supprimer_menu' menu.id %}" class="btn btn-danger btn-sm"
                 onclick="return confirm('Supprimer ce menu ?')">Supprimer</a>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <p>Aucun menu enregistré.</p>
      {% endfor %}
    </div>
  </div>
</div>
{% endblock %}
